<div class="con">
    <!-- main -->
    <div id="main">
        <div id="content">

            <!-- Форма для добавления или обновления продукта -->
            <div class="container mt-4">
                <form (ngSubmit)="productObj.id ? onUpdate() : onSave()" class="mb-4 p-3 bg-light border rounded shadow-sm">
                    <h5 class="form-title">{{ productObj.id ? 'Обновить продукт' : 'Добавить продукт' }}</h5>
                    <div class="mb-3">
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Название продукта"
                            [(ngModel)]="productObj.name"
                            name="name"
                            required
                        />
                    </div>
                    <div class="mb-3">
                        <textarea
                            class="form-control"
                            placeholder="Описание продукта"
                            [(ngModel)]="productObj.description"
                            name="description"
                            rows="3"
                        ></textarea>
                    </div>
                    <div class="mb-3">
                        <input
                            type="number"
                            class="form-control"
                            placeholder="Цена"
                            [(ngModel)]="productObj.price"
                            name="price"
                            required
                        />
                    </div>
                    <div class="mb-3">
                        <input
                            type="text"
                            class="form-control"
                            placeholder="ID категории"
                            [(ngModel)]="productObj.category_id"
                            name="category_id"
                            required
                        />
                    </div>
                    <div class="mb-3">
                        <input
                            type="file"
                            class="form-control"
                            (change)="onFileChange($event)"
                            name="image_path"
                        />
                    </div>
                    <button type="submit" class="btn btn-primary">
                        {{ productObj.id ? 'Обновить' : 'Добавить' }}
                    </button>
                </form>

                <!-- Блок для создания Excel-файла -->
                <div class="mb-4 p-3 bg-light border rounded shadow-sm">
                    <h5 class="form-title">Создание Excel-файла</h5>
                    <button class="btn btn-success" (click)="onCreateExcel()">
                        Скачать Excel
                    </button>
                </div>

                <!-- Таблица для отображения продуктов -->
                <table class="table table-hover">
                    <thead class="thead-light">
                        <tr>
                            <th>ID</th>
                            <th>Название</th>
                            <th>Описание</th>
                            <th>Цена</th>
                            <th>Категория</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let product of productList">
                            <td>{{ product.id }}</td>
                            <td>{{ product.name }}</td>
                            <td>{{ product.description }}</td>
                            <td>{{ product.price }}</td>
                            <td>{{ product.category_id }}</td>
                            <td>
                                <button class="btn btn-primary btn-sm me-2" (click)="onEdit(product)">Редактировать</button>
                                <button class="btn btn-danger btn-sm" (click)="onDelete(product.id)">Удалить</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div> <!-- content -->
    </div> <!-- main -->
</div> <!-- con -->
